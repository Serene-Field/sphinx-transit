<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Computer Network 17 | BGP Measurement Project &mdash; serenefield-sphinx  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Computer Network 18 | VoIP and Live/On-Demand Streaming" href="note18.html" />
    <link rel="prev" title="Computer Network 16｜DNS Censorship, Connectivity Disruption" href="note16.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            serenefield-sphinx
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">DevOps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html">⛴️  Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#ckad">☸️  CKAD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#advanced-k8s">⛵️  Advanced K8s</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#apache-solr">🥐  Apache Solr</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#hadoop-ecosystem">🐘  Hadoop Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#web-application">📄  Web Application</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Japanese</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html">🏯  Learning Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#n5">🏯  N5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#n4">🏯  N4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#id1">🎶  音楽</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guitar</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Guitar/index.html">🎸  Level 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Guitar/index.html#level-2">🎸  Level 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OMSCS</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">💻  Computer Network</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="note1.html">Computer Network 1｜Introduction to Computer Network, OSI Model, Principles, and Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="note2.html">Computer Network 2 | Introduction to Transport Layer, UDP and TCP, Congestion Control, Fairness</a></li>
<li class="toctree-l2"><a class="reference internal" href="note3.html">Computer Network 3 | Spanning Tree Protocol Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="note4.html">Computer Network 4 | Introduction to Routing, Link State, Distance Vector, RIP, OSPF, Hot Potato Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="note5.html">Computer Network 5 | Distance Vector Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="note6.html">Computer Network 6 | Introduction to Autonomous Systems, BGP Routing, and Peering Through IXPs</a></li>
<li class="toctree-l2"><a class="reference internal" href="note7.html">Computer Network 7｜Implement MiniNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="note8.html">Computer Network 8 | Introduction to Routers and Prefix Match</a></li>
<li class="toctree-l2"><a class="reference internal" href="note9.html">Computer Network 9｜Packet Classification, Packet Scheduling, Traffic Scheduling</a></li>
<li class="toctree-l2"><a class="reference internal" href="note10.html">Computer Network 10 | Midterm Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="note11.html">Computer Network 11 | Introduction of SDN and SDN Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="note12.html">Computer Network 12 | SDN Firewall Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="note13.html">Computer Network 13 | Advanced SDN Topics, ONOS, Data Plane Programming, P4, SDX</a></li>
<li class="toctree-l2"><a class="reference internal" href="note14.html">Computer Network 14 ｜ Introduction to Internet Security, DNS Abuse, Network Reputation, BGP Hijacking, DDoS Attack</a></li>
<li class="toctree-l2"><a class="reference internal" href="note15.html">Computer Network 15 ｜ BGP Hijacking Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="note16.html">Computer Network 16｜DNS Censorship, Connectivity Disruption</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Computer Network 17 | BGP Measurement Project</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bgpstream">1. BGPStream</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-file-and-rib-file">2. Update File and RIB File</a></li>
<li class="toctree-l3"><a class="reference internal" href="#project-restrictions">3. Project Restrictions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rubics">4. Rubics</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-1a">5. Task 1A</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-1b">6. Task 1B</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-2">7. Task 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-3">8. Task 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-4">9. Task 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="#task-1c">10. Task 1C</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-tips">11. Other Tips</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="note18.html">Computer Network 18 | VoIP and Live/On-Demand Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="note19.html">Computer Network 19 | Content Distribution Networks (CDNs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="note20.html">Computer Network 20 | Final Review</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#high-performance-computing">💻  High Performance Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#information-security">💻  Information Security</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Arts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Arts/index.html">🖼️  Drawing - Perspective</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Arts/index.html#blender-basic">🧊  Blender - Basic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Arts/index.html#blender-anime">🎥  Blender - Anime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tests</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tests/index.html">🧪  Sphinx Tests</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">serenefield-sphinx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">💻  Computer Network</a></li>
      <li class="breadcrumb-item active">Computer Network 17 | BGP Measurement Project</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/OMSCS/CN/note17.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="computer-network-17-bgp-measurement-project">
<h1>Computer Network 17 | BGP Measurement Project<a class="headerlink" href="#computer-network-17-bgp-measurement-project" title="Permalink to this heading"></a></h1>
<section id="bgpstream">
<h2>1. BGPStream<a class="headerlink" href="#bgpstream" title="Permalink to this heading"></a></h2>
<p><a class="reference external" href="https://bgpstream.caida.org/">BGPStream</a> is an open-source python package that can be used for live and historical BGP data analysis. It can be installed through,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>pybgpstream
</pre></div>
</div>
<p>In this project we will be using the python environment in the virtual machine so <code class="docutils literal notranslate"><span class="pre">pybgpstream</span></code> is already installed.</p>
<p>To gather BGP information using BGPStream, we have to use an object called Route Collectors (or <code class="docutils literal notranslate"><span class="pre">collecter</span></code>s). he code for accessing a collector or set of collectors directly usually looks like this,</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">pybgpstream</span><span class="o">.</span><span class="n">BGPStream</span><span class="p">(</span>
    <span class="n">record_type</span><span class="o">=</span><span class="s2">&quot;updates&quot;</span><span class="p">,</span>
    <span class="n">from_time</span><span class="o">=</span><span class="s2">&quot;2017-07-07 00:00:00&quot;</span><span class="p">,</span>
    <span class="n">until_time</span><span class="o">=</span><span class="s2">&quot;2017-07-07 00:10:00 UTC&quot;</span><span class="p">,</span>
    <span class="n">collectors</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;route-views.sg&quot;</span><span class="p">,</span> <span class="s2">&quot;route-views.eqix&quot;</span><span class="p">],</span>
    <span class="nb">filter</span><span class="o">=</span><span class="s2">&quot;peer 11666 and prefix more 210.180.0.0/16&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<p>In this project, we will use only the historical data so there’s no need to specify the collector. We can easily set up and configure streams with,</p>
<div class="highlight-Python notranslate"><div class="highlight"><pre><span></span><span class="n">stream</span> <span class="o">=</span> <span class="n">pybgpstream</span><span class="o">.</span><span class="n">BGPStream</span><span class="p">(</span><span class="n">data_interface</span><span class="o">=</span><span class="s2">&quot;singlefile&quot;</span><span class="p">)</span>
<span class="n">stream</span><span class="o">.</span><span class="n">set_data_interface_option</span><span class="p">(</span><span class="s2">&quot;singlefile&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">fpath</span><span class="p">)</span>
</pre></div>
</div>
<p>Where,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code> should be either <code class="docutils literal notranslate"><span class="pre">&quot;rib-file&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;upd-file&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fpath</span></code> is a string representing the path to a specific cache file</p></li>
</ul>
</section>
<section id="update-file-and-rib-file">
<h2>2. Update File and RIB File<a class="headerlink" href="#update-file-and-rib-file" title="Permalink to this heading"></a></h2>
<p>In this project, we have two types of cached files with BGP data. Let’s read some example cache files. Before trying to run <code class="docutils literal notranslate"><span class="pre">bgpreader</span></code> , <code class="docutils literal notranslate"><span class="pre">ldconfig</span></code> command should be used to create the necessary links to the installed package on the VM,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>sudo<span class="w"> </span>ldconfig
</pre></div>
</div>
<p>Then we can view an update file <code class="docutils literal notranslate"><span class="pre">./rrc04/update_files/ris.rrc04.updates.1609476900.300.cache</span></code> through,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>bgpreader<span class="w"> </span>-e<span class="w"> </span>--data-interface<span class="w"> </span>singlefile<span class="w"> </span>--data-interface-option<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>upd-file<span class="o">=</span>./rrc04/update_files/ris.rrc04.updates.1609476900.300.cache<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--filter<span class="w"> </span><span class="s1">&#39;ipv 4&#39;</span>
</pre></div>
</div>
<p>Select one line from the result as,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">update</span><span class="o">|</span><span class="n">A</span><span class="o">|</span><span class="mf">1499385779.000000</span><span class="o">|</span><span class="n">routeviews</span><span class="o">|</span><span class="n">route</span><span class="o">-</span><span class="n">views</span><span class="o">.</span><span class="n">eqix</span><span class="o">|</span><span class="kc">None</span><span class="o">|</span><span class="kc">None</span><span class="o">|</span><span class="mi">11666</span><span class="o">|</span><span class="mf">206.126.236.24</span><span class="o">|</span><span class="mf">210.180.224.0</span><span class="o">/</span><span class="mi">19</span><span class="o">|</span><span class="mf">206.126.236.24</span><span class="o">|</span><span class="mi">11666</span> <span class="mi">3356</span> <span class="mi">3786</span><span class="o">|</span><span class="mi">11666</span><span class="p">:</span><span class="mi">1000</span> <span class="mi">3356</span><span class="p">:</span><span class="mi">3</span> <span class="mi">3356</span><span class="p">:</span><span class="mi">2003</span> <span class="mi">3356</span><span class="p">:</span><span class="mi">575</span> <span class="mi">3786</span><span class="p">:</span><span class="mi">0</span> <span class="mi">3356</span><span class="p">:</span><span class="mi">22</span> <span class="mi">11666</span><span class="p">:</span><span class="mi">1002</span> <span class="mi">3356</span><span class="p">:</span><span class="mi">666</span> <span class="mi">3356</span><span class="p">:</span><span class="mi">86</span><span class="o">|</span><span class="kc">None</span><span class="o">|</span><span class="kc">None</span>
</pre></div>
</div>
<p>In the record, the “|” character separates different fields. We also have,</p>
<ul class="simple">
<li><p>type <code class="docutils literal notranslate"><span class="pre">A</span></code>: stands for Advertisement</p></li>
<li><p>advertised prefix: <code class="docutils literal notranslate"><span class="pre">210.180.224.0/19</span></code></p></li>
<li><p>AS path: <code class="docutils literal notranslate"><span class="pre">11666</span> <span class="pre">3356</span> <span class="pre">3786</span></code></p></li>
<li><p>original AS: <code class="docutils literal notranslate"><span class="pre">3786</span></code>, the last ASID in the AS path</p></li>
</ul>
<p>For Routing Information Base (RIB) files, we can also use the <code class="docutils literal notranslate"><span class="pre">bgpreader</span></code> tool to read a cached file,</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>bgpreader<span class="w"> </span>-e<span class="w"> </span>--data-interface<span class="w"> </span>singlefile<span class="w"> </span>--data-interface-option<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>rib-file<span class="o">=</span>./rrc04/rib_files/ris.rrc04.ribs.1262332740.120.cache<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--filter<span class="w"> </span><span class="s1">&#39;ipv 4&#39;</span>
</pre></div>
</div>
<p>In the result, consecutive “|” characters indicate fields without data.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">R</span><span class="o">|</span><span class="n">R</span><span class="o">|</span><span class="mf">1445306400.000000</span><span class="o">|</span><span class="n">routeviews</span><span class="o">|</span><span class="n">route</span><span class="o">-</span> <span class="n">views</span><span class="o">.</span><span class="n">sfmix</span><span class="o">|||</span><span class="mi">32354</span><span class="o">|</span><span class="mf">206.197.187.5</span><span class="o">|</span><span class="mf">1.0.0.0</span><span class="o">/</span><span class="mi">24</span><span class="o">|</span><span class="mf">206.197.187.5</span><span class="o">|</span><span class="mi">3235</span> <span class="mi">4</span> <span class="mi">15169</span><span class="o">|</span><span class="mi">15169</span><span class="o">|||</span>
</pre></div>
</div>
</section>
<section id="project-restrictions">
<h2>3. Project Restrictions<a class="headerlink" href="#project-restrictions" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Don’t import <code class="docutils literal notranslate"><span class="pre">os</span></code> or <code class="docutils literal notranslate"><span class="pre">pathlib</span></code>. This is because Gradescope does not mirror the directory layout from the provided files. Use the values from <code class="docutils literal notranslate"><span class="pre">cache_files</span></code> parameter instead.</p></li>
<li><p>Do not pull your own data. Use the cache files locate the directory within this project.</p></li>
</ul>
</section>
<section id="rubics">
<h2>4. Rubics<a class="headerlink" href="#rubics" title="Permalink to this heading"></a></h2>
<p>Only <code class="docutils literal notranslate"><span class="pre">bgpm.py</span></code> is required to submitted to Gradescope.</p>
<ul class="simple">
<li><p>Task 1A (10pts)</p></li>
<li><p>Task 1B (10pts)</p></li>
<li><p>Task 1C (10pts)</p></li>
<li><p>Task 2 (30pts)</p></li>
<li><p>Task 3 (20pts)</p></li>
<li><p>Task 4 (20pts)</p></li>
</ul>
</section>
<section id="task-1a">
<h2>5. Task 1A<a class="headerlink" href="#task-1a" title="Permalink to this heading"></a></h2>
<p>Generally, task 1 will measure BGP routing table growth so we can assume the input files are RIB files.</p>
<p>Complete function <code class="docutils literal notranslate"><span class="pre">unique_prefixes_by_snapshot</span></code>. This function is used to measure the number of <strong>unique</strong> advertised prefixes over time.</p>
<p>Each input file in <code class="docutils literal notranslate"><span class="pre">cache_files</span></code> is an annual snapshot and it’s already chronologically sorted. It should return a list containing the number of unique IP prefixes for each input file like <code class="docutils literal notranslate"><span class="pre">[2,</span> <span class="pre">5]</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">stream</span></code> is a list of BGP record elements <code class="docutils literal notranslate"><span class="pre">elem</span></code> with each element represents one BGP record. Here are some useful queries,</p>
<ul class="simple">
<li><p>Get the prefix: <code class="docutils literal notranslate"><span class="pre">pfx</span> <span class="pre">=</span> <span class="pre">elem.fields[&quot;prefix&quot;]</span></code></p></li>
<li><p>Get AS path: <code class="docutils literal notranslate"><span class="pre">ASPath</span> <span class="pre">=</span> <span class="pre">elem.fields[&quot;as-path&quot;].split(&quot;</span> <span class="pre">&quot;)</span></code></p></li>
<li><p>Get the origin AS: <code class="docutils literal notranslate"><span class="pre">origin</span> <span class="pre">=</span> <span class="pre">elem.fields[&quot;as-path&quot;].split(&quot;</span> <span class="pre">&quot;)[-1]</span></code></p></li>
</ul>
<p>After implementation, run the script <code class="docutils literal notranslate"><span class="pre">check_solution.py</span></code> for verification. Also git the implemented resolution.</p>
</section>
<section id="task-1b">
<h2>6. Task 1B<a class="headerlink" href="#task-1b" title="Permalink to this heading"></a></h2>
<p>Let’s now calculate the number of unique ASes over time. We should take all the ASes in the AS path into account.</p>
<p>Note that the AS path can have corner case like <code class="docutils literal notranslate"><span class="pre">25152</span> <span class="pre">2914</span> <span class="pre">18687</span> <span class="pre">{7829,14265}</span></code>. In this case we should count <code class="docutils literal notranslate"><span class="pre">{7829,14265}</span></code> as only 1 ASes.</p>
<p>There’s also another edge case when ASpath is empty. We have to skip these cases in the loop.</p>
<p>Because we have tested the Task 1A, before testing we can comment out the line <code class="docutils literal notranslate"><span class="pre">(TASK_1A,</span> <span class="pre">unique_prefixes_by_snapshot,</span> <span class="pre">&quot;rib_files&quot;)</span></code> so that we will skip the check process for task 1A.</p>
</section>
<section id="task-2">
<h2>7. Task 2<a class="headerlink" href="#task-2" title="Permalink to this heading"></a></h2>
<p>We’ll skip task 1c for now because it’s not easy to implement.</p>
<p>The idea is to get the shortest path length for each origin AS in each RIB cached file (or called a “snapshot”). The returned vaule should be a dictionary with ASIDs as fields and lists of shortest path length as values. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;455&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s2">&quot;533&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]}</span>
</pre></div>
</div>
<p>There are also some corner cases,</p>
<ul class="simple">
<li><p>if origin AS not in a snapshot, the corresponding shortest path length should be 0</p></li>
<li><p>if there’s a set of ASes for the origin AS, the set is counted as one unique AS</p></li>
<li><p>The ASes in the set is considered a different AS</p></li>
<li><p>filter out all paths of length 1</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">defaultdict</span></code> can be used in this task to simplify the procedure. Also, <code class="docutils literal notranslate"><span class="pre">tqdm</span></code> can be used to track the iterating process. Note that <code class="docutils literal notranslate"><span class="pre">tqdm</span></code> doesn’t come with the VM so we have to <code class="docutils literal notranslate"><span class="pre">pip</span></code> install it.</p>
</section>
<section id="task-3">
<h2>8. Task 3<a class="headerlink" href="#task-3" title="Permalink to this heading"></a></h2>
<p>In this task, we will focus on the AW events of the update files. An AW event is defined as the event that a prefix gets Advertised (A) and then Withdrawn (W). This matters because this information propagates and affects the volume of the associated BGP traffic.</p>
<p>There are two types of withdraws in the AW events,</p>
<ul class="simple">
<li><p>explicit withdrawals: a prefix is advertised with an announcement and is then withdrawn</p></li>
<li><p>implicit withdrawals: a prefix is advertised and then re-advertised with different BGP attributes</p></li>
</ul>
<p>In this task, we will only consider the explicit withdrawals. The duration of an AW event is considered to be the time slot between the last A and first W for a specific prefix.</p>
<p>The returned dictionary should be a dictionary where each key is a peerIP, and each value equals another dictionary where the field is prefix and the value is a list of explicit AW event durations. For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;192.65.185.137&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;185.202.130.0/24&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="mf">30.0</span><span class="p">,</span>
            <span class="mf">20.0</span>
        <span class="p">]</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note that prefix is not necessary in every update record so we have to use <code class="docutils literal notranslate"><span class="pre">._maybe_field(&quot;prefix&quot;)</span></code> method instead of <code class="docutils literal notranslate"><span class="pre">.fields[&quot;prefix&quot;]</span></code></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pfx</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">_maybe_field</span><span class="p">(</span><span class="s2">&quot;prefix&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Some other queries are useful in this task,</p>
<ul class="simple">
<li><p>update peer address: <code class="docutils literal notranslate"><span class="pre">elem.peer_address</span></code></p></li>
<li><p>update time: <code class="docutils literal notranslate"><span class="pre">elem.time</span></code></p></li>
<li><p>update type (<code class="docutils literal notranslate"><span class="pre">A</span></code> or <code class="docutils literal notranslate"><span class="pre">W</span></code>): <code class="docutils literal notranslate"><span class="pre">elem.type</span></code></p></li>
</ul>
<p>There are two general tips we should take care of,</p>
<ul class="simple">
<li><p>We should assume the records across snapshots are seamless. This means an <code class="docutils literal notranslate"><span class="pre">A</span></code> record for the last snapshot can impact the next <code class="docutils literal notranslate"><span class="pre">W</span></code> record</p></li>
<li><p>Make sure we considered <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">W</span></code> records with both the same peer IP and the same prefix. The durations across different peer IPs or prefixes would be meaningless</p></li>
</ul>
</section>
<section id="task-4">
<h2>9. Task 4<a class="headerlink" href="#task-4" title="Permalink to this heading"></a></h2>
<p>Task 4 is to measure the duration of Real-Time BlackHoling (RTBH) events. It’s very similar to the task 3 and we will start the explaination from the definition of a RTBH event.</p>
<p>In this task we will still examine the update files. for a given peerIP/prefix pair is the time elapsed between the last (A)nnouncement of the peerIP/prefix that is tagged with an RTBH community value and the first (W)ithdrawal of the peerIP/prefix.</p>
<p>The solution of this task can be modified based on the solution of task 3.</p>
<p>Note the blackholing tag for the community should be ending with <code class="docutils literal notranslate"><span class="pre">:666</span></code> and we should check it through <code class="docutils literal notranslate"><span class="pre">._maybe_field('communities')</span></code> because <code class="docutils literal notranslate"><span class="pre">communities</span></code> is not a necessary field.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">community</span> <span class="o">=</span> <span class="n">elem</span><span class="o">.</span><span class="n">_maybe_field</span><span class="p">(</span><span class="s1">&#39;communities&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this task, there are some extra corner cases,</p>
<ul class="simple">
<li><p>Given the stream A1 A2 A3(RTBH) A4 A5 W1 W2 for a specific peerIP/prefix pair, the announcement A3(RTBH) followed by A4 is an implicit withdrawal. There is no explicit withdrawal and, thus, no RTBH event.</p></li>
<li><p>Check carefully about the case that <code class="docutils literal notranslate"><span class="pre">community</span></code> is an empty set. If this happens, the loop for checking blackholing tag <code class="docutils literal notranslate"><span class="pre">:666</span></code> would quite and cause some edge cases.</p></li>
</ul>
</section>
<section id="task-1c">
<h2>10. Task 1C<a class="headerlink" href="#task-1c" title="Permalink to this heading"></a></h2>
<p>In the end, let’s implement the task 1C. We will compute the top 10 origin ASes ordered by percentage increase (smallest to largest) of advertised prefixes.</p>
<p>The percentage change for number of prefixes of an origin AS between two snapshots is defined by,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># of prefixes for origin in snapshot1 / # of prefixes for origin in snapshot2 - 1</span>
</pre></div>
</div>
<p>In this task, we will consider the total unique prefixes change which means we should identify the first and the last snapshot where the origin AS appeared and calculate the change between them.</p>
<p>Therefore, for each AS we have to conduct the following steps,</p>
<ul class="simple">
<li><p>Count the number of unique prefixes for each snapshot</p></li>
<li><p>Filter out the snapshots with 0 prefix</p></li>
<li><p>Calculate the total percentage change for each origin</p></li>
<li><p>Report the top 10 origins</p></li>
</ul>
<p>Here are some tips for debugging,</p>
<ul class="simple">
<li><p>There can be a tied result but a simple <code class="docutils literal notranslate"><span class="pre">sorted</span></code> function would give the correct order</p></li>
<li><p>Don’t use data structures like <code class="docutils literal notranslate"><span class="pre">[set()]*num</span></code> because the specific pointer to <code class="docutils literal notranslate"><span class="pre">set()</span></code> will be copied and all values in the list would be the same.</p></li>
</ul>
</section>
<section id="other-tips">
<h2>11. Other Tips<a class="headerlink" href="#other-tips" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p>Make sure you remove all the packets not in the environment, for example, <code class="docutils literal notranslate"><span class="pre">tqdm</span></code> before you submit</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="note16.html" class="btn btn-neutral float-left" title="Computer Network 16｜DNS Censorship, Connectivity Disruption" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="note18.html" class="btn btn-neutral float-right" title="Computer Network 18 | VoIP and Live/On-Demand Streaming" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Yufeng Xing.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>