<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Computer Network 14 ÔΩú Introduction to Internet Security, DNS Abuse, Network Reputation, BGP Hijacking, DDoS Attack &mdash; serenefield-sphinx  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Computer Network 15 ÔΩú BGP Hijacking Project" href="note15.html" />
    <link rel="prev" title="Computer Network 13 | Advanced SDN Topics, ONOS, Data Plane Programming, P4, SDX" href="note13.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            serenefield-sphinx
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">DevOps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html">‚õ¥Ô∏è  Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#ckad">‚ò∏Ô∏è  CKAD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#advanced-k8s">‚õµÔ∏è  Advanced K8s</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#apache-solr">ü•ê  Apache Solr</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#hadoop-ecosystem">üêò  Hadoop Ecosystem</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Japanese</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html">üèØ  Learning Resource</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#n5">üèØ  N5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#n4">üèØ  N4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#id1">üé∂  Èü≥Ê•Ω</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guitar</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Guitar/index.html">üé∏  Level 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Guitar/index.html#level-2">üé∏  Level 2</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OMSCS</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">üíª  Computer Network</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="note1.html">Computer Network 1ÔΩúIntroduction to Computer Network, OSI Model, Principles, and Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="note2.html">Computer Network 2 | Introduction to Transport Layer, UDP and TCP, Congestion Control, Fairness</a></li>
<li class="toctree-l2"><a class="reference internal" href="note3.html">Computer Network 3 | Spanning Tree Protocol Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="note4.html">Computer Network 4 | Introduction to Routing, Link State, Distance Vector, RIP, OSPF, Hot Potato Routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="note5.html">Computer Network 5 | Distance Vector Implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="note6.html">Computer Network 6 | Introduction to Autonomous Systems, BGP Routing, and Peering Through IXPs</a></li>
<li class="toctree-l2"><a class="reference internal" href="note7.html">Computer Network 7ÔΩúImplement MiniNet</a></li>
<li class="toctree-l2"><a class="reference internal" href="note8.html">Computer Network 8 | Introduction to Routers and Prefix Match</a></li>
<li class="toctree-l2"><a class="reference internal" href="note9.html">Computer Network 9ÔΩúPacket Classification, Packet Scheduling, Traffic Scheduling</a></li>
<li class="toctree-l2"><a class="reference internal" href="note10.html">Computer Network 10 | Midterm Review</a></li>
<li class="toctree-l2"><a class="reference internal" href="note11.html">Computer Network 11 | Introduction of SDN and SDN Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="note12.html">Computer Network 12 | SDN Firewall Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="note13.html">Computer Network 13 | Advanced SDN Topics, ONOS, Data Plane Programming, P4, SDX</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Computer Network 14 ÔΩú Introduction to Internet Security, DNS Abuse, Network Reputation, BGP Hijacking, DDoS Attack</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#introduction-to-internet-security">1. Introduction to Internet Security</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#internet-security">(1) Internet Security</a></li>
<li class="toctree-l4"><a class="reference internal" href="#secure-communication">(2) Secure Communication</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#dns-abuse">2. DNS Abuse</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dns-records">(1) DNS Records</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-usage-1-round-robin-dns-rrdns">(2) DNS Usage 1: Round Robin DNS (RRDNS)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-based-content-delivery-networks-cdns">(3) DNS-based Content Delivery Networks (CDNs)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#fast-flux-service-networks-ffsns">(4) Fast-Flux Service Networks (FFSNs)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#network-reputation">3. Network Reputation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#rogue-networks">(1) Rogue networks</a></li>
<li class="toctree-l4"><a class="reference internal" href="#infer-network-reputation">(2) Infer Network Reputation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dns-abuse-detection-finding-rogue-networks-fire-system">(3) DNS Abuse Detection: Finding Rogue Networks (FIRE) System</a></li>
<li class="toctree-l4"><a class="reference internal" href="#limitations-of-dns-abuse-detection">(4) Limitations of DNS Abuse Detection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#interconnection-pattern-inference-aswatch">(5) Interconnection Pattern Inference: ASwatch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#likelihood-of-breach">(6) Likelihood of Breach</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bgp-hijacking">4. BGP Hijacking</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bgp-hijacking-category-1-by-affected-prefix">(1) BGP Hijacking Category 1: by Affected Prefix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-hijacking-category-2-by-as-path-announcement">(2) BGP Hijacking Category 2: by AS-Path announcement</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-hijacking-category-3-by-data-plane-traffic-manipulation">(3) BGP Hijacking Category 3: by Data-Plane traffic manipulation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-hijacking-attacks-causes">(4) BGP Hijacking Attacks Causes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-hijacking-example-1-hijack-prefix">(5) BGP Hijacking Example 1: Hijack Prefix</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-hijacking-example-2-hijack-path">(6) BGP Hijacking Example 2: Hijack Path</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-hijacking-detection-system">(7) BGP Hijacking Detection System</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-hijacking-mitigation-techniques">(8) BGP Hijacking Mitigation Techniques</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#distributed-denial-of-service-ddos-attack">5. Distributed Denial of Service (DDoS) Attack</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id1">(1) Distributed Denial of Service (DDoS) Attack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ip-spoofing">(2) IP spoofing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ddos-reflection-and-amplification">(3) DDoS Reflection and Amplification</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ddos-attack-defense">(4) DDoS Attack Defense</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-flowspec">(5) BGP Flowspec</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ddos-mitigation-technique-bgp-blackholing">(6) DDoS Mitigation Technique: BGP Blackholing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-blackholing-example-1-peering-or-isp">(7) BGP Blackholing Example 1: Peering or ISP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-blackholing-example-2-ixp">(8) BGP Blackholing Example 2: IXP</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bgp-blackholing-limitations">(9) BGP Blackholing Limitations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="note15.html">Computer Network 15 ÔΩú BGP Hijacking Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="note16.html">Computer Network 16ÔΩúDNS Censorship, Connectivity Disruption</a></li>
<li class="toctree-l2"><a class="reference internal" href="note17.html">Computer Network 17 | BGP Measurement Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="note18.html">Computer Network 18 | VoIP and Live/On-Demand Streaming</a></li>
<li class="toctree-l2"><a class="reference internal" href="note19.html">Computer Network 19 | Content Distribution Networks (CDNs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="note20.html">Computer Network 20 | Final Review</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#high-performance-computing">üíª  High Performance Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#information-security">üíª  Information Security</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Arts</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Arts/index.html">üñºÔ∏è  Drawing - Perspective</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Arts/index.html#blender-basic">üßä  Blender - Basic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Arts/index.html#blender-anime">üé•  Blender - Anime</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tests</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tests/index.html">üß™  Sphinx Tests</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">serenefield-sphinx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">üíª  Computer Network</a></li>
      <li class="breadcrumb-item active">Computer Network 14 ÔΩú Introduction to Internet Security, DNS Abuse, Network Reputation, BGP Hijacking, DDoS Attack</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/OMSCS/CN/note14.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="computer-network-14-introduction-to-internet-security-dns-abuse-network-reputation-bgp-hijacking-ddos-attack">
<h1>Computer Network 14 ÔΩú Introduction to Internet Security, DNS Abuse, Network Reputation, BGP Hijacking, DDoS Attack<a class="headerlink" href="#computer-network-14-introduction-to-internet-security-dns-abuse-network-reputation-bgp-hijacking-ddos-attack" title="Permalink to this heading">ÔÉÅ</a></h1>
<section id="introduction-to-internet-security">
<h2>1. Introduction to Internet Security<a class="headerlink" href="#introduction-to-internet-security" title="Permalink to this heading">ÔÉÅ</a></h2>
<section id="internet-security">
<h3>(1) Internet Security<a class="headerlink" href="#internet-security" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>The Internet was not designed or built with security in mind, so all the protocols that we have learned so far can be exploited by attackers for malicious purposes. Here are some of the common attacks we will discuss,</p>
<ul class="simple">
<li><p>Traffic attraction attacks: BGP Hijacking</p></li>
<li><p>Denial-of-Service (DoS) attacks</p></li>
<li><p>Distributed Denial-of-Service (DDoS) attacks</p></li>
</ul>
</section>
<section id="secure-communication">
<h3>(2) Secure Communication<a class="headerlink" href="#secure-communication" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>When we talk about secure communication, we are talking about the following properties,</p>
<ul class="simple">
<li><p>Confidentiality</p></li>
</ul>
<p>The message that is sent from the sender to the receiver is only available to the two parties.</p>
<ul class="simple">
<li><p>Integrity</p></li>
</ul>
<p>The message should not be somehow modified while in transit.</p>
<ul class="simple">
<li><p>Authentication</p></li>
</ul>
<p>The communication parties should confirm the identities.</p>
<ul class="simple">
<li><p>Availability</p></li>
</ul>
<p>The message should be available.</p>
</section>
</section>
<section id="dns-abuse">
<h2>2. DNS Abuse<a class="headerlink" href="#dns-abuse" title="Permalink to this heading">ÔÉÅ</a></h2>
<section id="dns-records">
<h3>(1) DNS Records<a class="headerlink" href="#dns-records" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>DNS records (aka zone files) are instructions that live in authoritative DNS servers and provide domain information. Here are some common types of DNS record types,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code>: IPv4 address for a domain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AAAA</span></code>: IPv6 address for a domain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CNAME</span></code>: canonical name, used to forward one domain to another domain. This is common for subdomain to its parent domain.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MX</span></code>: redirect to mail server</p></li>
</ul>
<p>Note that in the DNS records,</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&#64;</span></code>: means exact match of the root domain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">*</span></code>: means wildcard prefix match of the domain</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">www</span></code>: means the prefix of the domain should be <code class="docutils literal notranslate"><span class="pre">www</span></code></p></li>
</ul>
<p>Each record will also have a Time to Live (TTL) value which represents how long will this record be valid after a DNS client receives it. When a record reaches it‚Äôs TTL, it will no longer be valid and the client has to request for it again. TTL is also the longest time that a record update will be aware of on all the DNS clients.</p>
</section>
<section id="dns-usage-1-round-robin-dns-rrdns">
<h3>(2) DNS Usage 1: Round Robin DNS (RRDNS)<a class="headerlink" href="#dns-usage-1-round-robin-dns-rrdns" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>With RRDNS, the DNS server responds to a DNS request with a list of DNS A records (it indicates the IP address). Then the list of DNS A records will be cycled in a round robin manner. This list is only a part of the mapping list.</p>
<p><img alt="" src="https://i.imgur.com/isWacKR.png" /></p>
<p>When the list arrives at the DNS client, it can then choose a record using different strategies,</p>
<ul class="simple">
<li><p><strong>first record</strong>: so it will balance the load</p></li>
<li><p><strong>closest record</strong>: in terms of network proximity</p></li>
</ul>
<p>Note that if the DNS lookup happens within the same TTL period, the list of records will be the same in a different order because of round robin. However, if it‚Äôs not the same TTL period, it‚Äôs likely the DNS client will receive a different set of A records.</p>
</section>
<section id="dns-based-content-delivery-networks-cdns">
<h3>(3) DNS-based Content Delivery Networks (CDNs)<a class="headerlink" href="#dns-based-content-delivery-networks-cdns" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>CDNs also use DNS-based techniques to distribute content but using more complex strategies. CDNs not only distribute the load among multiple servers at a single location, but it also distribute these servers across the world.</p>
<p>When accessing the name of the service using DNS, the CDN computes the nearest edge server (or in the figure as surrogate server) and returns its IP address to the DNS client. This results in the content being moved closer to the DNS client which increases responsiveness and availability. CDNs can also react quickly to changes in links as their TTL is lower than RRDNS.</p>
<p><img alt="" src="https://i.imgur.com/fSSveEv.png" /></p>
</section>
<section id="fast-flux-service-networks-ffsns">
<h3>(4) Fast-Flux Service Networks (FFSNs)<a class="headerlink" href="#fast-flux-service-networks-ffsns" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Although RRDNS provides reliability for the network, it can also be benefit to spammers. One famous criminal technique is called the fast-flux service networks (FFSNs).</p>
<p>FFSNs utilitize the feature DNS provides.</p>
<ul class="simple">
<li><p>DNS <code class="docutils literal notranslate"><span class="pre">A</span></code> record list: a DNS request receives multiple A records make it hard to shut down online scams because even if there‚Äôs one IP functional, the spam is still working</p></li>
<li><p>Low TTL: FFSNs also use low TTLs lower than RRDNS and CDNs so that it will rapidly change in DNS answers. Each time the TTL of current records reached, the records will expired and new IP addresses will be captured from a zombie network (a large set of compromised machines). The machines in this network are then used as proxies to communicate with the mothership node (the node hosts spam contents and it is normally blocked).</p></li>
</ul>
<p><img alt="" src="https://i.imgur.com/nmQRCkP.png" /></p>
</section>
</section>
<section id="network-reputation">
<h2>3. Network Reputation<a class="headerlink" href="#network-reputation" title="Permalink to this heading">ÔÉÅ</a></h2>
<section id="rogue-networks">
<h3>(1) Rogue networks<a class="headerlink" href="#rogue-networks" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Rogue networks are networks whose main purpose is malicious activity such as phishing, hosting spam pages, hosting pirated software, etc.</p>
</section>
<section id="infer-network-reputation">
<h3>(2) Infer Network Reputation<a class="headerlink" href="#infer-network-reputation" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>There are several ways to infer a network reputation,</p>
<ul class="simple">
<li><p>By Evidence of DNS Abuse</p></li>
<li><p>By Interconnection Patterns</p></li>
<li><p>By Likelihood of Breach</p></li>
</ul>
<p>We will talk in details about them in the following discussions.</p>
</section>
<section id="dns-abuse-detection-finding-rogue-networks-fire-system">
<h3>(3) DNS Abuse Detection: Finding Rogue Networks (FIRE) System<a class="headerlink" href="#dns-abuse-detection-finding-rogue-networks-fire-system" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>FIRE (Finding Rogue Networks) is a system that monitors the data plane for rogue networks. It uses three main data sources to identify hosts that likely belong to rogue networks,</p>
<ul class="simple">
<li><p>Botnet command and control providers: use centralized command and control (C&amp;C) on networks where it is unlikely to be taken down.</p>
<ul>
<li><p>IRC-based botnets</p></li>
<li><p>HTTP-based botnets</p></li>
</ul>
</li>
<li><p>Drive-by-download hosting providers: method of malware installation without interaction with the user. It occurs when the victims visit a web page that contains an exploit for their vulnerable browser.</p></li>
<li><p>Phish housing providers: phishing pages mimic aithentic sites to steal the login credentials, credit card numbers, as well as other personal information. These pages are hosted on compromised servers and usually are up only for a short period of time.</p></li>
</ul>
<p>Because each of these data sources produces a list of malicious IP addresses daily, FIRE can combine the information from these three lists to identify rogue AS. The approach is to identify the most malicious networks as those which have the highest ratio of malicious IP addresses as compared to the total owned IP addresses of
that AS.</p>
<p>Therefore, only if a network has a large enough concentration of blacklisted IPs for a long enough period of time, it will be flagged as malicious.</p>
</section>
<section id="limitations-of-dns-abuse-detection">
<h3>(4) Limitations of DNS Abuse Detection<a class="headerlink" href="#limitations-of-dns-abuse-detection" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>In practice, it is not feasible to monitor the traffic of all networks as decribed with the FIRE system. There are several reasons,</p>
<ul class="simple">
<li><p>It requires a <strong>long time</strong> to confirm a malicious behavior</p></li>
<li><p>The approach does not differentiate well between malicious and cyberactors (i.e. networks that are legitimate but abused)</p></li>
</ul>
<p>With the limitations mentioned above, <code class="docutils literal notranslate"><span class="pre">ASwatch</span></code> was improved as an other network reputation inference technique.</p>
</section>
<section id="interconnection-pattern-inference-aswatch">
<h3>(5) Interconnection Pattern Inference: ASwatch<a class="headerlink" href="#interconnection-pattern-inference-aswatch" title="Permalink to this heading">ÔÉÅ</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">ASwatch</span></code> uses the information exclusively from the data plane and it also aims to detect malicious networks run by cyberactors (also called bulletproof). It was first mention in <a class="reference external" href="https://conferences.sigcomm.org/sigcomm/2015/pdf/papers/p625.pdf">this article</a>.</p>
<p>The idea of <code class="docutils literal notranslate"><span class="pre">ASwatch</span></code>  is based on the observation that bulletproof ASes have</p>
<ul class="simple">
<li><p>distinct interconnection patterns</p></li>
<li><p>overall different control plane behavior from legitimate networks</p></li>
</ul>
<p>The <code class="docutils literal notranslate"><span class="pre">ASwatch</span></code> system has two phases the training phase and the operation phase.</p>
<ul class="simple">
<li><p>Training phase</p>
<ul>
<li><p>The system is given a list of known malicious and legitimate ASes, and then it learns control-plane behavior typical of both types of ASes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ASwatch</span></code> then tracks ASes‚Äô business relationships and their BGP updates/withdrawals patterns. Commonly, there are three main features that <code class="docutils literal notranslate"><span class="pre">ASwatch</span></code> will look into</p>
<ul>
<li><p>Rewiring activities</p>
<ul>
<li><p>frequent changes in customers/providers</p></li>
<li><p>connecting with less popular providers</p></li>
</ul>
</li>
<li><p>IP Space Fragmentation and Churn: to avoid all the host IPs being taken down if detected</p>
<ul>
<li><p>use small BGP prefixes</p></li>
<li><p>advertise a small section of its IP space</p></li>
</ul>
</li>
<li><p>BGP Routing Dynamics</p>
<ul>
<li><p>periodically announcing prefixes for short periods of time</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>Operational phase</p>
<ul>
<li><p>Given an unknown AS, <code class="docutils literal notranslate"><span class="pre">ASwatch</span></code> uses the model to assign a reputation score based on its features.</p></li>
<li><p>If one AS got a low reputation score for several days, it will be inferred as malicious</p></li>
</ul>
</li>
</ul>
</section>
<section id="likelihood-of-breach">
<h3>(6) Likelihood of Breach<a class="headerlink" href="#likelihood-of-breach" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Another way to infer a network reputation is to use a system for predicting the likelihood of a security breach within an organization. The system will only use externally observable features so the model can be scalable to all organizations.</p>
<p>The idea of predicting with a likelihood of breach is based on the random forest model with 258 features. These features can be classified into three classes,</p>
<ul class="simple">
<li><p>Mismanagement Symptoms</p>
<ul>
<li><p>Open Recursive Resolvers</p></li>
<li><p>DNS Source Port Randomization</p></li>
<li><p>BGP Misconfiguration</p></li>
<li><p>Untrusted HTTPS Certificates</p></li>
<li><p>Open SMTP Mail Relays</p></li>
</ul>
</li>
<li><p>Malicious Activities</p>
<ul>
<li><p>Capturing spam activity</p></li>
<li><p>Capturing phishing and malware activities</p></li>
<li><p>Capturing scanning activity</p></li>
</ul>
</li>
<li><p>Security Incident Reports</p>
<ul>
<li><p>VERIS Community Database</p></li>
<li><p>Hackmageddon</p></li>
<li><p>The Web Hacking Incidents Database</p></li>
</ul>
</li>
</ul>
<p>With these features for the random forest model, we can get a prediction on the likelihood of breach for us to infer whether a network is malicious or legitimate.</p>
</section>
</section>
<section id="bgp-hijacking">
<h2>4. BGP Hijacking<a class="headerlink" href="#bgp-hijacking" title="Permalink to this heading">ÔÉÅ</a></h2>
<section id="bgp-hijacking-category-1-by-affected-prefix">
<h3>(1) BGP Hijacking Category 1: by Affected Prefix<a class="headerlink" href="#bgp-hijacking-category-1-by-affected-prefix" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>In this class of hijacking attacks, we are primarily concerned with the IP prefixes that are advertised by BGP.</p>
<ul class="simple">
<li><p>Exact prefix hijacking</p></li>
</ul>
<p>Two different ASes (one genuine one counterfeit) announce a path for the same prefix, the routing is disruppted to the hijacker wherever the ASpath is shorter.</p>
<ul class="simple">
<li><p>Sub-prefix hijacking</p></li>
</ul>
<p>The hijacking AS works with a subprefix of the genuine prefix of the real AS, and as a result
route large/entire amount of traffic to the hijacking AS.</p>
<ul class="simple">
<li><p>Squatting</p></li>
</ul>
<p>In this type of attack, the hijacking AS announces a prefix that has not yet been announced by the owner AS.</p>
</section>
<section id="bgp-hijacking-category-2-by-as-path-announcement">
<h3>(2) BGP Hijacking Category 2: by AS-Path announcement<a class="headerlink" href="#bgp-hijacking-category-2-by-as-path-announcement" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>In this class of attacks, an illegitimate AS announces the AS-path for a prefix for which it doesn‚Äôt have ownership rights.</p>
<ul class="simple">
<li><p>Type-0 hijacking</p></li>
</ul>
<p>This is simply an AS announcing a prefix not owned by itself.</p>
<ul class="simple">
<li><p>Type-N hijacking</p></li>
</ul>
<p>This is an attack where the counterfeit AS announces an illegitimate path for a prefix that it does not own to create a fake link (path) between different ASes.</p>
<ul class="simple">
<li><p>Type-U hijacking</p></li>
</ul>
<p>In this attack the hijacking AS does not modify the AS-PATH but may change the prefix.</p>
</section>
<section id="bgp-hijacking-category-3-by-data-plane-traffic-manipulation">
<h3>(3) BGP Hijacking Category 3: by Data-Plane traffic manipulation<a class="headerlink" href="#bgp-hijacking-category-3-by-data-plane-traffic-manipulation" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>In this class of attacks, the intention of the attacker is to hijack the network traffic and manipulate the redirected network traffic on its way to the receiving AS.</p>
<ul class="simple">
<li><p>Dropped</p></li>
</ul>
<p>Blackholing (BH) attack, means the traffic intercepted by the hijacker can never reach the intended destination.</p>
<ul class="simple">
<li><p>Manipulated</p></li>
</ul>
<p>Man-in-the-middle (MM) attack, means the traffic intercepted by the hijacker can be eavesdropped or manipulated before it reaches the receiving AS</p>
<ul class="simple">
<li><p>Impersonated</p></li>
</ul>
<p>Imposture (IM) attack, means the network traffic of the victim AS is impersonated and the response to this network traffic is sent back to the sender.</p>
</section>
<section id="bgp-hijacking-attacks-causes">
<h3>(4) BGP Hijacking Attacks Causes<a class="headerlink" href="#bgp-hijacking-attacks-causes" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>There are several causes behind the BGP hijacking attacks.</p>
<ul class="simple">
<li><p>Human Error</p></li>
</ul>
<p>Accendital routing misconfiguration due to manual errors can lead to large scale exact-prefix hijacking. For example, China Telecom‚Äôs Type-0 hijacking</p>
<ul class="simple">
<li><p>Targeted Attack</p></li>
</ul>
<p>Hijacking AS intercepts network traffic (MM attack) while operating in stealth mode to remain under the radar on the control plane (Type-N and Type-U attacks). For example, Visa and Mastercard‚Äôs traffic were hijacked by in 2017.</p>
<ul class="simple">
<li><p>High Impact Attack</p></li>
</ul>
<p>The attacker is obvious in their intent to cause widespread disruption of services. For example, Pakistan Telecom in a Type-0 sub-prefix hijacking, essentially blackholing all of YouTube‚Äôs services worldwide for nearly 2 hours.</p>
</section>
<section id="bgp-hijacking-example-1-hijack-prefix">
<h3>(5) BGP Hijacking Example 1: Hijack Prefix<a class="headerlink" href="#bgp-hijacking-example-1-hijack-prefix" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Let‚Äôs suppose we have AS1 ~ AS5 and AS1 has a subnet with prefix 10.10.0.0/16 and it announce this prefix to the network so the other ASes in the network can route to this subnet. Assume we have the following network topology, as a result, we have the paths as,</p>
<p><img alt="" src="https://i.imgur.com/Vx5an60.png" /></p>
<p>Now suppose AS4 is a malicious AS and it has no path to subnet with prefix 10.10.0.0/16. However, it can announce fake messages to pretend that 10.10.0.0/16 belongs to AS4.</p>
<p><img alt="" src="https://i.imgur.com/8wwLC3H.png" /></p>
<p>As a result, several paths are modified,</p>
<ul class="simple">
<li><p>AS3 to 10.10.0.0/16 now routing to AS4</p></li>
<li><p>AS5 to 10.10.0.0/16 now routing to AS4</p></li>
</ul>
<p>So in this network, both AS3 and AS4 can not route to subnet 10.10.0.0/16 because the path is now misleading.</p>
</section>
<section id="bgp-hijacking-example-2-hijack-path">
<h3>(6) BGP Hijacking Example 2: Hijack Path<a class="headerlink" href="#bgp-hijacking-example-2-hijack-path" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Another way for AS4 to hijack the route is by annoncing the path. For example, AS4 can create a fake to pretend it has a direct path to AS1. So,</p>
<p><img alt="" src="https://i.imgur.com/2x6aEgd.png" /></p>
<p>As a result, the path from AS5 to AS1 is modified,</p>
<ul class="simple">
<li><p>AS5 to 10.10.0.0/16 now routing to AS4</p></li>
</ul>
<p>In this case, AS4 performs BGP hijacking by hijacking a path.</p>
</section>
<section id="bgp-hijacking-detection-system">
<h3>(7) BGP Hijacking Detection System<a class="headerlink" href="#bgp-hijacking-detection-system" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>One of the high level idea for BGP hijacking defense is to use a detection system called ARTEMIS. RTEMIS is a system that is run locally by network operators to safeguard its own prefixes against malicious BGP hijacking attempts.</p>
<p>The key idea of ARTEMIS is as following,</p>
<ul class="simple">
<li><p>configuration file: prefixes owned by the network are listed</p></li>
<li><p>mechanism for BGP updates: allows receiving updates from local routers and monitoring services</p></li>
</ul>
<p>Using the local configuration file as a reference, for the received BGP updates, ARTEMIS can check for prefixes and AS-PATH fields and trigger alerts when there are anomalies.</p>
</section>
<section id="bgp-hijacking-mitigation-techniques">
<h3>(8) BGP Hijacking Mitigation Techniques<a class="headerlink" href="#bgp-hijacking-mitigation-techniques" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>The ARTEMIS system uses two automated techniques in mitigating BGP hijacking attacks,</p>
<ul class="simple">
<li><p>Prefix deaggregation</p></li>
</ul>
<p>The affected network can either contact other networks or it can simply deaggregate the prefixes that were targeted by announcing more specific prefixes of a certain prefix.</p>
<ul class="simple">
<li><p>Mitigation with Multiple Origin AS (MOAS)</p></li>
</ul>
<p>The idea is to have third party organizations and service providers do BGP announcements for a given network. When a BGP hijacking event occurs, the following steps occur,</p>
<ul class="simple">
<li><p>a. A third party is notified and immediately announces from the hijacked prefix.</p></li>
<li><p>b. In this way, network traffic from across the world is attracted to the third party organization, which then scrubbs it and tunnels it to the legitimate AS</p></li>
</ul>
</section>
</section>
<section id="distributed-denial-of-service-ddos-attack">
<h2>5. Distributed Denial of Service (DDoS) Attack<a class="headerlink" href="#distributed-denial-of-service-ddos-attack" title="Permalink to this heading">ÔÉÅ</a></h2>
<section id="id1">
<h3>(1) Distributed Denial of Service (DDoS) Attack<a class="headerlink" href="#id1" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Distributed Denial of Service (DDoS) attack is an attempt to compromise a server or network resources with a flood of traffic. To achieve this, the attacker first compromises and deploys flooding servers (slaves).</p>
<p><img alt="" src="https://i.imgur.com/Kws5EFG.png" /></p>
</section>
<section id="ip-spoofing">
<h3>(2) IP spoofing<a class="headerlink" href="#ip-spoofing" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>IP spoofing is the act of setting a false IP address in the source field of a packet with the purpose of impersonating a legitimate server. In DDoS attacks, this can happen in two forms,</p>
<ul class="simple">
<li><p>spoof source IP address</p></li>
</ul>
<p>It results in the response of the server sent to some other client instead of the attacker‚Äôs machine. It also results in wastage of network resources and the client
resources while also causing denial of service to legitimate users.</p>
<ul class="simple">
<li><p>spoof same source IP and destination IP</p></li>
</ul>
<p>In the second type of attack, the attacker sets the same IP address in both the source and destination IP fields. This results in the server sending the replies to itself, causing it to crash.</p>
</section>
<section id="ddos-reflection-and-amplification">
<h3>(3) DDoS Reflection and Amplification<a class="headerlink" href="#ddos-reflection-and-amplification" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>A <strong>reflector</strong> in DDoS is any server that sends a response to a request. In a <strong>reflection attack</strong>, the attackers use a set of reflectors to initiate an attack on the victim.</p>
<p>For example, the master directs the slaves to send spoofed requests to a very large number of reflectors, usually in the range of 1 million. The slaves set the source address of the packets to the victim‚Äôs IP address, thereby redirecting the response of the reflectors to the victim.</p>
<p>Thus, the victim receives responses from millions of reflectors resulting in exhaustion of its bandwidth. In addition, the resources of the victim is wasted in processing these responses, making it unable to respond to legitimate requests.</p>
<p><img alt="" src="https://i.imgur.com/tYGjPtV.png" /></p>
<p>The master commands the three slaves to send spoofed requests to the reflectors, which in turn sends traffic to the victim. This is in contrast with the conventional DDoS attack we saw in the previous section, where the slaves directly send traffic to the victim.</p>
<p>Note that the victim can easily identify the reflectors from the response packets. However, the reflector cannot identify the slave sending the spoofed requests.</p>
<p>If the requests are chosen in such a way that the reflectors send large responses to the victim, it is a <strong>reflection and amplification attack</strong>. Not only would the victim receive traffic from millions of servers, the response sent would be large in size, making it further difficult for the victim to handle it.</p>
</section>
<section id="ddos-attack-defense">
<h3>(4) DDoS Attack Defense<a class="headerlink" href="#ddos-attack-defense" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Then, let‚Äôs look into some tools that we can leverage to help detect the DDoS attack.</p>
<ul class="simple">
<li><p><strong>Traffic Scrubbing</strong> Services: A scrubbing service diverts the incoming traffic to a specialized server, where the traffic is ‚Äúscrubbed‚Äù into either clean or unwanted traffic. The problem of this tools is the monetary costs of the service (in-time subscription, setup and other recurring costs). Also the performance will be decreased because of rerouting.</p>
<ul>
<li><p>Clean traffic: sent to its original destination</p></li>
<li><p>Unwanted traffic: filtered out</p></li>
</ul>
</li>
<li><p><strong>Access Control List (ACL)</strong> Filters: deployed by ISPs or IXPs at their AS border routers to filter out unwanted traffic. The drawbacks of these filters include limited scalability and since the filtering does not occur at the ingress points, it can exhaust the bandwidth to a neighboring AS.</p></li>
<li><p><strong>BGP Flowspec</strong>: The flow specification feature of BGP, called <code class="docutils literal notranslate"><span class="pre">Flowspec</span></code>, helps to mitigate DDoS attacks by supporting the deployment and propagation of fine-grained filters across AS domain borders. Let‚Äôs discuss more about it in the next section.</p></li>
</ul>
</section>
<section id="bgp-flowspec">
<h3>(5) BGP Flowspec<a class="headerlink" href="#bgp-flowspec" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>BGP Flowspec is an extension to the BGP protocol which allows rules to be created on the traffic flows and take corresponding actions.</p>
<p>This feature of BGP can help mitigate DDoS attacks by specifying appropriate rules. The AS domain borders supporting BGP Flowspec are capable of matching packets in a specific flow based on a variety of parameters such as source IP, destination IP, packet length, protocol used, etc. Please refer to <a class="reference external" href="https://content.cisco.com/chapter.sjs?uri=/searchable/chapter/content/en/us/td/docs/routers/ncs6000/software/ncs6k-r7-0/routing/configuration/guide/b-routing-cg-ncs6000-70x/b-routing-cg-ncs6000-70x_chapter_011.html.xml">this document</a> for the 12 types of matching components.</p>
<p>Let‚Äôs now see an example. Suppose we want to specify the following rule as ‚Äúall HTTP/HTTPS traffic from port 80 and 443 to one of the Google servers with IP 172.217.19.195 from subnet 130.89.161.0/24‚Äù, then we will have,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>{
‚Äútype 1‚Äù: &quot;172.217.19.195/32‚Äù
‚Äútype 2&quot;: &quot;130.89.161.0/24&quot; &quot;type 3&quot;: [6],
&quot;type 5&quot;: [80, 443], 
&quot;action&quot;: {
    &quot;type &quot;: &quot;traffic-rate&quot;, 
    ‚Äúvalue &quot;: &quot;0&quot;
    }
}
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">traffic-rate</span> <span class="pre">=</span> <span class="pre">0</span></code> means we discard the matching traffic. The other possible actions include rate limiting, redirecting or filtering. If no rule is specified, the default action for a rule is to accept the incoming traffic.</p>
<p>In contrast to ACL filters, FlowSpec leverages the BGP control plane making it easier to add rules to all the routers simultaneously. Although FlowSpec is seen to be effective in intra-domain environment, it is not so popular in inter-domain environments as it depends on trust and cooperation among competitive networks. Also, it might not scale for large attacks where the attack traffic originates from multiple sources as it would multiple rules or combining the sources into one prefix.</p>
</section>
<section id="ddos-mitigation-technique-bgp-blackholing">
<h3>(6) DDoS Mitigation Technique: BGP Blackholing<a class="headerlink" href="#ddos-mitigation-technique-bgp-blackholing" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>BGP blackholing is a countermeasure to mitigate a DDoS attack. With this mechanism, all the attack traffic to a targeted DoS destination is dropped to a null location.</p>
<p>BGP blackholing is implemented with either the help of IX or the upstream provider (ISP). The blackhole messages are tagged with a specific BGP blackhole community attribute, usually publicly available, to differentiate it from the regular routing updates.</p>
</section>
<section id="bgp-blackholing-example-1-peering-or-isp">
<h3>(7) BGP Blackholing Example 1: Peering or ISP<a class="headerlink" href="#bgp-blackholing-example-1-peering-or-isp" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Let‚Äôs see two examples. Assume the IP <code class="docutils literal notranslate"><span class="pre">130.149.1.1</span></code> in AS2 is under attack.</p>
<p>First, if the blackholing provider is a peer or an upstream provider, the AS must announce its associated blackhole community along with the blackhole prefix.</p>
<p><img alt="" src="https://i.imgur.com/fllet4m.png" /></p>
<p>To mitigate this attack, AS2 (victim network) announces a blackholing message to AS1, which is the provider network. The message contains,</p>
<ul class="simple">
<li><p>the IP <code class="docutils literal notranslate"><span class="pre">130.149.1.1/32</span></code>, which is the host IP under attack</p></li>
<li><p>the community field <code class="docutils literal notranslate"><span class="pre">AS1:666</span></code>, which is the blackholing community of the AS1 provider</p></li>
</ul>
<p>Once the provider receives the message, AS1 identifies it as a blackholing message since it contains its blackholing community and sets the next-hop field of the <code class="docutils literal notranslate"><span class="pre">130.149.1.1</span></code> IP to a blackholing IP, thereby effectively dropping all the incoming traffic to host <code class="docutils literal notranslate"><span class="pre">130.149.1.1</span></code>. Thus, the victim host stops receiving the attack traffic that was sent to it.</p>
</section>
<section id="bgp-blackholing-example-2-ixp">
<h3>(8) BGP Blackholing Example 2: IXP<a class="headerlink" href="#bgp-blackholing-example-2-ixp" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>Let‚Äôs look at the scenario, where blackholing is implemented with the help of the IXP.</p>
<p>If the AS is a member of an IXP and it‚Äôs under attack, it sends the blackholing messages to the <strong>IXP route server</strong> when a member connects to the route server. The route server then announces the message to all the connected IXP member ASes, which then drops the traffic towards the blackholed prefix.</p>
<p><img alt="" src="https://i.imgur.com/HLWEPdk.png" /></p>
<p>Here when AS2 is under attack, AS2 connects to the
router server of the IXP and sends a BGP blackholing message. The message contains,</p>
<ul class="simple">
<li><p>IP under attack: <code class="docutils literal notranslate"><span class="pre">130.149.1.1</span></code></p></li>
<li><p>Community field <code class="docutils literal notranslate"><span class="pre">ASIXP:666</span></code></p></li>
</ul>
<p>The route server identifies it as a blackholing message and sets the next-hop of <code class="docutils literal notranslate"><span class="pre">130.149.1.1</span></code> to a blackholing IP. It propagates this announcement to all its member ASes, which then drops all the traffic to host <code class="docutils literal notranslate"><span class="pre">130.149.1.1</span></code>.</p>
</section>
<section id="bgp-blackholing-limitations">
<h3>(9) BGP Blackholing Limitations<a class="headerlink" href="#bgp-blackholing-limitations" title="Permalink to this heading">ÔÉÅ</a></h3>
<p>There are also some limitations of the BGP blackholing.</p>
<ul class="simple">
<li><p>Unreachable</p></li>
</ul>
<p>One of the major drawbacks of BGP blackholing is that the destination under attack becomes unreachable since all the traffic including the legitimate traffic is dropped.</p>
<ul class="simple">
<li><p>Collateral damage</p></li>
</ul>
<p>All the traffic including legitimate traffic via a neighbor AS is dropped.</p>
<ul class="simple">
<li><p>Rejection leads to ineffectiveness</p></li>
</ul>
<p>If the majority of the attack traffic is coming through a neighbor AS choosing not to participate in blackholing and rejecting the updates, then the mitigation is ineffective. The same is true if a large number of peers do not accept the blackholing announcements.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="note13.html" class="btn btn-neutral float-left" title="Computer Network 13 | Advanced SDN Topics, ONOS, Data Plane Programming, P4, SDX" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="note15.html" class="btn btn-neutral float-right" title="Computer Network 15 ÔΩú BGP Hijacking Project" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Yufeng Xing.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>