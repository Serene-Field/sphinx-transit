<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Intro to Information Security 1 | Modular Calculation and Software Vulnerabilities &mdash; serenefield-sphinx  documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Intro to Information Security 2 | Capture The Flag and Operating System Vulnerabilities" href="note2.html" />
    <link rel="prev" title="High Performance Computing 9 | Midterm Review" href="../HPC/note9.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> serenefield-sphinx
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">DevOps</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html">⛴️  Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devops/index.html#ckad">☸️  CKAD</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Japanese</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html">🏯  N5</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#n4">🏯  N4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#n3">🏯  N3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#n2">🏯  N2</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Jap/index.html#n1">🏯  N1</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guitar</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Guitar/index.html">🎸  Basic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Guitar/index.html#intermediate">🎸  Intermediate</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">OMSCS</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../index.html">💻  Computer Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html#high-performance-computing">💻  High Performance Computing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html#information-security">💻  Information Security</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Intro to Information Security 1 | Modular Calculation and Software Vulnerabilities</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mod-calculation">0. Mod Calculation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-mod-b">(1) A mod B</a></li>
<li class="toctree-l4"><a class="reference internal" href="#congruence">(2) Congruence</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modular-addition">(3) Modular Addition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modular-subtraction">(4) Modular Subtraction</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modular-multiplication">(5) Modular Multiplication</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exponentiation">(6) Exponentiation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#quick-trick-of-2-based-exponentiation">(7) Quick Trick of 2-Based Exponentiation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exponentiation-trick">(8) Exponentiation Trick</a></li>
<li class="toctree-l4"><a class="reference internal" href="#modular-inverse">(9) Modular Inverse</a></li>
<li class="toctree-l4"><a class="reference internal" href="#co-prime">(10) Co-prime</a></li>
<li class="toctree-l4"><a class="reference internal" href="#prime-root">(11) Prime Root</a></li>
<li class="toctree-l4"><a class="reference internal" href="#relative-prime">(12) Relative Prime</a></li>
<li class="toctree-l4"><a class="reference internal" href="#totients">(13) Totients</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#introduction">1. Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cyber-security-requirements-cia-rule">(1) Cyber Security Requirements (CIA rule)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#role-of-the-good-guys">(2) Role of the Good Guys</a></li>
<li class="toctree-l4"><a class="reference internal" href="#ways-to-address-cyber-security">(3) Ways to address cyber security</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#software-vulnerabilities">2. Software Vulnerabilities</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#common-software-vulnerabilities">(1) Common Software Vulnerabilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vulnerable-program-example">(2) Vulnerable Program Example</a></li>
<li class="toctree-l4"><a class="reference internal" href="#understanding-the-stack">(4) Understanding the Stack</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bypass-case">(5) Bypass Case</a></li>
<li class="toctree-l4"><a class="reference internal" href="#shellcode">(6) Shellcode</a></li>
<li class="toctree-l4"><a class="reference internal" href="#variations-of-buffer-overflow">(7) Variations of Buffer Overflow</a></li>
<li class="toctree-l4"><a class="reference internal" href="#defense-against-overflow">(8) Defense Against Overflow</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="note2.html">Intro to Information Security 2 | Capture The Flag and Operating System Vulnerabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="note3.html">Intro to Information Security 3 | Log4J Vulnerabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="note4.html">Intro to Information Security 4 | Malware Analysis</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tests</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tests/index.html">🧪  Sphinx Tests</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">serenefield-sphinx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">💻  Computer Network</a></li>
      <li class="breadcrumb-item active">Intro to Information Security 1 | Modular Calculation and Software Vulnerabilities</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/OMSCS/IIS/note1.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="intro-to-information-security-1-modular-calculation-and-software-vulnerabilities">
<h1>Intro to Information Security 1 | Modular Calculation and Software Vulnerabilities<a class="headerlink" href="#intro-to-information-security-1-modular-calculation-and-software-vulnerabilities" title="Permalink to this heading"></a></h1>
<section id="mod-calculation">
<h2>0. Mod Calculation<a class="headerlink" href="#mod-calculation" title="Permalink to this heading"></a></h2>
<section id="a-mod-b">
<h3>(1) A mod B<a class="headerlink" href="#a-mod-b" title="Permalink to this heading"></a></h3>
<p>If A is a negative number, then the result should be,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Result</span> <span class="o">=</span> <span class="n">A</span> <span class="o">-</span> <span class="n">B</span> <span class="o">*</span> <span class="n">floor</span><span class="p">(</span><span class="n">A</span><span class="o">/</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="congruence">
<h3>(2) Congruence<a class="headerlink" href="#congruence" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">If</span> <span class="n">A</span> <span class="o">==</span> <span class="n">B</span> <span class="n">mod</span> <span class="n">C</span><span class="p">,</span> <span class="n">then</span> <span class="n">A</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">==</span> <span class="n">B</span> <span class="n">mod</span> <span class="n">C</span>
<span class="n">If</span> <span class="n">A</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">==</span> <span class="n">B</span> <span class="n">mod</span> <span class="n">C</span><span class="p">,</span> <span class="n">then</span> <span class="n">A</span> <span class="o">==</span> <span class="n">B</span> <span class="n">mod</span> <span class="n">C</span>
</pre></div>
</div>
</section>
<section id="modular-addition">
<h3>(3) Modular Addition<a class="headerlink" href="#modular-addition" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">A</span> <span class="o">+</span> <span class="n">B</span><span class="p">)</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">+</span> <span class="n">B</span> <span class="n">mod</span> <span class="n">C</span><span class="p">)</span> <span class="n">mod</span> <span class="n">C</span>
</pre></div>
</div>
</section>
<section id="modular-subtraction">
<h3>(4) Modular Subtraction<a class="headerlink" href="#modular-subtraction" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">B</span><span class="p">)</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">-</span> <span class="n">B</span> <span class="n">mod</span> <span class="n">C</span><span class="p">)</span> <span class="n">mod</span> <span class="n">C</span>
</pre></div>
</div>
</section>
<section id="modular-multiplication">
<h3>(5) Modular Multiplication<a class="headerlink" href="#modular-multiplication" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">A</span> <span class="o">*</span> <span class="n">B</span><span class="p">)</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">*</span> <span class="n">B</span> <span class="n">mod</span> <span class="n">C</span><span class="p">)</span> <span class="n">mod</span> <span class="n">C</span>
</pre></div>
</div>
</section>
<section id="exponentiation">
<h3>(6) Exponentiation<a class="headerlink" href="#exponentiation" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">^</span><span class="n">n</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span> <span class="n">mod</span> <span class="n">C</span><span class="p">)</span><span class="o">^</span><span class="n">n</span> <span class="n">mod</span> <span class="n">C</span>
</pre></div>
</div>
</section>
<section id="quick-trick-of-2-based-exponentiation">
<h3>(7) Quick Trick of 2-Based Exponentiation<a class="headerlink" href="#quick-trick-of-2-based-exponentiation" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="n">n</span><span class="p">)</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">A</span><span class="o">^</span><span class="p">(</span><span class="mi">2</span><span class="o">^</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="n">mod</span> <span class="n">C</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="n">mod</span> <span class="n">C</span>
</pre></div>
</div>
</section>
<section id="exponentiation-trick">
<h3>(8) Exponentiation Trick<a class="headerlink" href="#exponentiation-trick" title="Permalink to this heading"></a></h3>
<p>Suppose we have to calculate M^N mod C, where N is a large number, then we can calculate the result by</p>
<ul class="simple">
<li><p>Rewrite N to binary form <code class="docutils literal notranslate"><span class="pre">bin(N)</span></code></p></li>
<li><p>Convert the exponentials to polynominals with powers of 2</p></li>
<li><p>Calculate each term with the quick trick of 2-based exonentiation</p></li>
<li><p>Combine the individual powers to find the final answer</p></li>
</ul>
</section>
<section id="modular-inverse">
<h3>(9) Modular Inverse<a class="headerlink" href="#modular-inverse" title="Permalink to this heading"></a></h3>
<p>The modular inverse of A mod C is B satisifies,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">A</span> <span class="n">B</span><span class="p">)</span> <span class="n">mod</span> <span class="n">C</span> <span class="o">==</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="co-prime">
<h3>(10) Co-prime<a class="headerlink" href="#co-prime" title="Permalink to this heading"></a></h3>
<p>Two integers a and b are said to be co-prime if the only positive integer integer that evenly divides both of them is 1.</p>
</section>
<section id="prime-root">
<h3>(11) Prime Root<a class="headerlink" href="#prime-root" title="Permalink to this heading"></a></h3>
<p>A number M is a prime root of a number N if every number co-prime to N is congtuent to a power of M mod N.</p>
</section>
<section id="relative-prime">
<h3>(12) Relative Prime<a class="headerlink" href="#relative-prime" title="Permalink to this heading"></a></h3>
<p>It describes two numbers for which the only common factor is 1. In other words, relatively prime numbers have a greatest common factor (gcf) of 1.</p>
</section>
<section id="totients">
<h3>(13) Totients<a class="headerlink" href="#totients" title="Permalink to this heading"></a></h3>
<p>The totient function φ(n), also called Euler’s totient function, which is defined as the number of positive integers &lt;= n that are relatively prime to n, where 1 is counted as being relatively prime to all numbers.</p>
<p>Since a number less than or equal to and relatively prime to a given number is called a totative, the totient function phi(n) can be simply defined as the number of totatives of n.</p>
</section>
</section>
<section id="introduction">
<h2>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this heading"></a></h2>
<section id="cyber-security-requirements-cia-rule">
<h3>(1) Cyber Security Requirements (CIA rule)<a class="headerlink" href="#cyber-security-requirements-cia-rule" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Confidentiality: only some people can view it</p></li>
<li><p>Integrity: only some people can modify it</p></li>
<li><p>Availability: the data must exist somewhere</p></li>
</ul>
</section>
<section id="role-of-the-good-guys">
<h3>(2) Role of the Good Guys<a class="headerlink" href="#role-of-the-good-guys" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Prevention</p></li>
<li><p>Detection</p></li>
<li><p>Respnse</p></li>
<li><p>Recovery and remediation</p></li>
<li><p>Establish policies and mechanisms</p></li>
</ul>
</section>
<section id="ways-to-address-cyber-security">
<h3>(3) Ways to address cyber security<a class="headerlink" href="#ways-to-address-cyber-security" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Complexity is our enemy</p></li>
<li><p>Fail-safe defaults: allow only if someone really need the data</p></li>
<li><p>Complete mediation: no one should be able to bypass the monitor</p></li>
<li><p>Open design: don’t count on someone who will not find out your design</p></li>
<li><p>Least privilage: only have the privilege to the resource someone absoluately need</p></li>
<li><p>Psychological acceptability</p></li>
</ul>
</section>
</section>
<section id="software-vulnerabilities">
<h2>2. Software Vulnerabilities<a class="headerlink" href="#software-vulnerabilities" title="Permalink to this heading"></a></h2>
<section id="common-software-vulnerabilities">
<h3>(1) Common Software Vulnerabilities<a class="headerlink" href="#common-software-vulnerabilities" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Memory overflow</p></li>
<li><p>Stack buffer overflow</p>
<ul>
<li><p>Stacks are used in function/procedure calls</p></li>
<li><p>Stacks are also used for allocating memory</p>
<ul>
<li><p>local variables</p></li>
<li><p>parameteres</p></li>
<li><p>control information (return address)</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</section>
<section id="vulnerable-program-example">
<h3>(2) Vulnerable Program Example<a class="headerlink" href="#vulnerable-program-example" title="Permalink to this heading"></a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;strings.h&gt;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">allow_login</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">pwdstr</span><span class="p">[</span><span class="mi">12</span><span class="p">];</span>
<span class="w">    </span><span class="kt">char</span><span class="w"> </span><span class="n">targetpwd</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;MyPwd123&quot;</span><span class="p">;</span>
<span class="w">    </span>
<span class="w">    </span><span class="n">gets</span><span class="p">(</span><span class="n">pwdstr</span><span class="p">);</span>
<span class="w">    </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">strncmp</span><span class="p">(</span><span class="n">pwdstr</span><span class="p">,</span><span class="w"> </span><span class="n">targetpwd</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">allow_login</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">        </span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">allow_login</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Login request rejected&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Login request allowed&quot;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Now let’s look into the stack of this program.</p>
</section>
<section id="understanding-the-stack">
<h3>(4) Understanding the Stack<a class="headerlink" href="#understanding-the-stack" title="Permalink to this heading"></a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">----------------------</span> <span class="o">&lt;-</span> <span class="n">High</span> <span class="n">address</span> <span class="p">(</span><span class="n">addr</span><span class="p">)</span>
<span class="n">argc</span> <span class="o">=</span> <span class="mi">4</span> <span class="nb">bytes</span>
<span class="o">----------------------</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">addr</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">argv</span> <span class="o">=</span> <span class="mi">4</span> <span class="nb">bytes</span>
<span class="o">----------------------</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">addr</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span>
<span class="k">return</span> <span class="n">address</span> <span class="o">=</span> <span class="mi">4</span> <span class="nb">bytes</span>
<span class="o">----------------------</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">addr</span> <span class="o">-</span> <span class="mi">12</span><span class="p">)</span>
<span class="n">allowlogin</span> <span class="o">=</span> <span class="mi">4</span> <span class="nb">bytes</span>
<span class="o">----------------------</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">addr</span> <span class="o">-</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">pwdstr</span> <span class="o">=</span> <span class="mi">12</span> <span class="nb">bytes</span>
<span class="o">----------------------</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">addr</span> <span class="o">-</span> <span class="mi">28</span><span class="p">)</span>
<span class="n">targetpwd</span> <span class="o">=</span> <span class="mi">12</span> <span class="n">byte</span>
<span class="o">----------------------</span> <span class="o">&lt;-</span> <span class="p">(</span><span class="n">addr</span> <span class="o">-</span> <span class="mi">40</span><span class="p">)</span>
<span class="o">...</span>
<span class="o">----------------------</span> <span class="o">&lt;-</span> <span class="n">Low</span> <span class="n">address</span>
</pre></div>
</div>
</section>
<section id="bypass-case">
<h3>(5) Bypass Case<a class="headerlink" href="#bypass-case" title="Permalink to this heading"></a></h3>
<p>The problem of this program is that when we have the function <code class="docutils literal notranslate"><span class="pre">gets</span></code> read a string, it will not check the length of that string so that the input string can be longer than the memory we have allocated for the variable <code class="docutils literal notranslate"><span class="pre">pwdstr</span></code>. Therefore, the variable memory will overflow and it will continue writing to <code class="docutils literal notranslate"><span class="pre">allowlogin</span></code> variable. For example, if the input string is <code class="docutils literal notranslate"><span class="pre">BadPasswordHere!</span></code>, then</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>---------------------- &lt;- High address (addr)
argc = 4 bytes
---------------------- &lt;- (addr - 4)
argv = 4 bytes
---------------------- &lt;- (addr - 8)
return address = 4 bytes
---------------------- &lt;- (addr - 12)
allowlogin = ere!
---------------------- &lt;- (addr - 16)
pwdstr = BadPasswordH
---------------------- &lt;- (addr - 28)
targetpwd = MyPwd123
---------------------- &lt;- (addr - 40)
...
---------------------- &lt;- Low address
</pre></div>
</div>
<p>Then if we compare <code class="docutils literal notranslate"><span class="pre">pwdstr</span></code> and <code class="docutils literal notranslate"><span class="pre">targetpwd</span></code>, even though those two varibles will not match and the program will not assign 1 to <code class="docutils literal notranslate"><span class="pre">allowlogin</span></code>, this variable has already been overwritten by the input string that exceed 12 bytes (aka. <code class="docutils literal notranslate"><span class="pre">ere!</span></code>). In this case, we can still pass the check for this login.</p>
</section>
<section id="shellcode">
<h3>(6) Shellcode<a class="headerlink" href="#shellcode" title="Permalink to this heading"></a></h3>
<p>Shellcode creates a shell which allows it to execute any code the attacker wants. Basically, the attackers would like to allocate the following privileges,</p>
<ul class="simple">
<li><p>the host program</p></li>
<li><p>system service</p></li>
<li><p>OS root privileges</p></li>
</ul>
</section>
<section id="variations-of-buffer-overflow">
<h3>(7) Variations of Buffer Overflow<a class="headerlink" href="#variations-of-buffer-overflow" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p><strong>“return-to-libc” Attack</strong>: means to rewrite the return address to a standard library function. This works because if we can return to a standard library function and we are also able to setup some arguments or parameters for it on the stack, then we can execute a function with the argument of our choice.</p></li>
<li><p><strong>“Heap Overflow” Attack</strong>: Longer variables like the global variables are stored on the heap. The difference between a stack and a heap is that the heap doesn’t have a return address. However, the heap do have some function pointers and the data can be the tables of function pointers. So the data stored in the heap is overwritten and we are able to corrupt the memory in some sense as we have done before.</p></li>
<li><p><strong>“OpenSSL Heartbleed Vulnerability” Attack</strong>: the attacks above is about writing too much and overwriting the data. However, the overflow attacks don’t necessarily to be assoicated with writing data. OpenSSL heartbleed vulnerability happens when we read too much. It keeps reading beyond the variables that we are supposed to read.</p></li>
</ul>
</section>
<section id="defense-against-overflow">
<h3>(8) Defense Against Overflow<a class="headerlink" href="#defense-against-overflow" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>Programming language is crucial. Common safe programming languages are C++, Java, etc. A safe language should have the following traits:</p>
<ul>
<li><p>should be strongly typed</p></li>
<li><p>should do automatic bounds checks</p></li>
<li><p>should do automatic memory management</p></li>
</ul>
</li>
<li><p>Check inputs (All input is evil)</p></li>
<li><p>Use safer functions that do bounds checking</p></li>
<li><p>Use automatic tools to analyze code to flag potential unsafe vulnerabilities. These tools can be found at <a class="reference external" href="https://owasp.org/www-community/Source_Code_Analysis_Tools">OWASP</a>.</p>
<ul>
<li><p>they can flag potential unsafe fucntions/constructs</p></li>
<li><p>they can help mitigate security lapses (but can hardly eliminate all buffer overflow vulnerabilities)</p></li>
</ul>
</li>
<li><p>Use canary values: a canary value is written when a return address is stored in a stack frame and any attempts to rewrite the address using buffer overflow will result in the canary being rewritten and an overflow will be detected.</p></li>
<li><p>Address Space Layout Randomization (ASLR): this is a feature supported by the operating system that randomizes stack, heap, libc, etc. This makes it harder for the attacker to find important locations like libc function addresses.</p></li>
</ul>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../HPC/note9.html" class="btn btn-neutral float-left" title="High Performance Computing 9 | Midterm Review" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="note2.html" class="btn btn-neutral float-right" title="Intro to Information Security 2 | Capture The Flag and Operating System Vulnerabilities" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Yufeng Xing.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>